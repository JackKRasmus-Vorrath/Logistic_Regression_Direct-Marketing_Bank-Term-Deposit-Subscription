> table(bank.dat$subscribed)

   no   yes 
39922  5289 
> prop.table(table(bank.dat$subscribed))

       no       yes 
0.8830152 0.1169848 
> CrossTable(bank.dat$job.type, bank.dat$subscribed)

 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  45211 

 
                  | bank.dat$subscribed 
bank.dat$job.type |        no |       yes | Row Total | 
------------------|-----------|-----------|-----------|
           admin. |      4540 |       631 |      5171 | 
                  |     0.149 |     1.124 |           | 
                  |     0.878 |     0.122 |     0.114 | 
                  |     0.114 |     0.119 |           | 
                  |     0.100 |     0.014 |           | 
------------------|-----------|-----------|-----------|
      blue-collar |      9024 |       708 |      9732 | 
                  |    21.566 |   162.782 |           | 
                  |     0.927 |     0.073 |     0.215 | 
                  |     0.226 |     0.134 |           | 
                  |     0.200 |     0.016 |           | 
------------------|-----------|-----------|-----------|
     entrepreneur |      1364 |       123 |      1487 | 
                  |     1.978 |    14.926 |           | 
                  |     0.917 |     0.083 |     0.033 | 
                  |     0.034 |     0.023 |           | 
                  |     0.030 |     0.003 |           | 
------------------|-----------|-----------|-----------|
        housemaid |      1131 |       109 |      1240 | 
                  |     1.188 |     8.965 |           | 
                  |     0.912 |     0.088 |     0.027 | 
                  |     0.028 |     0.021 |           | 
                  |     0.025 |     0.002 |           | 
------------------|-----------|-----------|-----------|
       management |      8157 |      1301 |      9458 | 
                  |     4.532 |    34.211 |           | 
                  |     0.862 |     0.138 |     0.209 | 
                  |     0.204 |     0.246 |           | 
                  |     0.180 |     0.029 |           | 
------------------|-----------|-----------|-----------|
          retired |      1748 |       516 |      2264 | 
                  |    31.551 |   238.149 |           | 
                  |     0.772 |     0.228 |     0.050 | 
                  |     0.044 |     0.098 |           | 
                  |     0.039 |     0.011 |           | 
------------------|-----------|-----------|-----------|
    self-employed |      1392 |       187 |      1579 | 
                  |     0.004 |     0.028 |           | 
                  |     0.882 |     0.118 |     0.035 | 
                  |     0.035 |     0.035 |           | 
                  |     0.031 |     0.004 |           | 
------------------|-----------|-----------|-----------|
         services |      3785 |       369 |      4154 | 
                  |     3.729 |    28.148 |           | 
                  |     0.911 |     0.089 |     0.092 | 
                  |     0.095 |     0.070 |           | 
                  |     0.084 |     0.008 |           | 
------------------|-----------|-----------|-----------|
          student |       669 |       269 |       938 | 
                  |    30.626 |   231.167 |           | 
                  |     0.713 |     0.287 |     0.021 | 
                  |     0.017 |     0.051 |           | 
                  |     0.015 |     0.006 |           | 
------------------|-----------|-----------|-----------|
       technician |      6757 |       840 |      7597 | 
                  |     0.354 |     2.672 |           | 
                  |     0.889 |     0.111 |     0.168 | 
                  |     0.169 |     0.159 |           | 
                  |     0.149 |     0.019 |           | 
------------------|-----------|-----------|-----------|
       unemployed |      1101 |       202 |      1303 | 
                  |     2.136 |    16.119 |           | 
                  |     0.845 |     0.155 |     0.029 | 
                  |     0.028 |     0.038 |           | 
                  |     0.024 |     0.004 |           | 
------------------|-----------|-----------|-----------|
          unknown |       254 |        34 |       288 | 
                  |     0.000 |     0.003 |           | 
                  |     0.882 |     0.118 |     0.006 | 
                  |     0.006 |     0.006 |           | 
                  |     0.006 |     0.001 |           | 
------------------|-----------|-----------|-----------|
     Column Total |     39922 |      5289 |     45211 | 
                  |     0.883 |     0.117 |           | 
------------------|-----------|-----------|-----------|

 
> z <- melt(data.frame(table(bank.dat$job.type, bank.dat$subscribed)))
Using Var1, Var2 as id variables
> colnames(z) <- c("job.type", "subscribed","variable","value")
> ggplot(z, aes(subscribed, job.type)) +
+   geom_tile(aes(fill = value)) +
+   geom_text(aes(label = value), color="white") +
+   scale_x_discrete(expand = c(0,0)) +
+   scale_y_discrete(expand = c(0,0)) +
+   scale_fill_gradient("Legend label", low = "red", high = "green") + 
+   theme_bw()
> CrossTable(bank.dat$marital.status, bank.dat$subscribed)

 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  45211 

 
                        | bank.dat$subscribed 
bank.dat$marital.status |        no |       yes | Row Total | 
------------------------|-----------|-----------|-----------|
               divorced |      4585 |       622 |      5207 | 
                        |     0.036 |     0.272 |           | 
                        |     0.881 |     0.119 |     0.115 | 
                        |     0.115 |     0.118 |           | 
                        |     0.101 |     0.014 |           | 
------------------------|-----------|-----------|-----------|
                married |     24459 |      2755 |     27214 | 
                        |     7.645 |    57.707 |           | 
                        |     0.899 |     0.101 |     0.602 | 
                        |     0.613 |     0.521 |           | 
                        |     0.541 |     0.061 |           | 
------------------------|-----------|-----------|-----------|
                 single |     10878 |      1912 |     12790 | 
                        |    15.306 |   115.530 |           | 
                        |     0.851 |     0.149 |     0.283 | 
                        |     0.272 |     0.362 |           | 
                        |     0.241 |     0.042 |           | 
------------------------|-----------|-----------|-----------|
           Column Total |     39922 |      5289 |     45211 | 
                        |     0.883 |     0.117 |           | 
------------------------|-----------|-----------|-----------|

 
> z <- melt(data.frame(table(bank.dat$marital.status, bank.dat$subscribed)))
Using Var1, Var2 as id variables
> colnames(z) <- c("marital.status", "subscribed","variable","value")
> ggplot(z, aes(subscribed, marital.status)) +
+   geom_tile(aes(fill = value)) +
+   geom_text(aes(label = value), color="white") +
+   scale_x_discrete(expand = c(0,0)) +
+   scale_y_discrete(expand = c(0,0)) +
+   scale_fill_gradient("Legend label", low = "red", high = "green") + 
+   theme_bw()
> CrossTable(bank.dat$highest.educ, bank.dat$subscribed)

 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  45211 

 
                      | bank.dat$subscribed 
bank.dat$highest.educ |        no |       yes | Row Total | 
----------------------|-----------|-----------|-----------|
              primary |      6260 |       591 |      6851 | 
                      |     7.322 |    55.267 |           | 
                      |     0.914 |     0.086 |     0.152 | 
                      |     0.157 |     0.112 |           | 
                      |     0.138 |     0.013 |           | 
----------------------|-----------|-----------|-----------|
            secondary |     20752 |      2450 |     23202 | 
                      |     3.409 |    25.732 |           | 
                      |     0.894 |     0.106 |     0.513 | 
                      |     0.520 |     0.463 |           | 
                      |     0.459 |     0.054 |           | 
----------------------|-----------|-----------|-----------|
             tertiary |     11305 |      1996 |     13301 | 
                      |    16.483 |   124.412 |           | 
                      |     0.850 |     0.150 |     0.294 | 
                      |     0.283 |     0.377 |           | 
                      |     0.250 |     0.044 |           | 
----------------------|-----------|-----------|-----------|
              unknown |      1605 |       252 |      1857 | 
                      |     0.737 |     5.562 |           | 
                      |     0.864 |     0.136 |     0.041 | 
                      |     0.040 |     0.048 |           | 
                      |     0.036 |     0.006 |           | 
----------------------|-----------|-----------|-----------|
         Column Total |     39922 |      5289 |     45211 | 
                      |     0.883 |     0.117 |           | 
----------------------|-----------|-----------|-----------|

 
> z <- melt(data.frame(table(bank.dat$highest.educ, bank.dat$subscribed)))
Using Var1, Var2 as id variables
> colnames(z) <- c("highest.educ", "subscribed","variable","value")
> ggplot(z, aes(subscribed, highest.educ)) +
+   geom_tile(aes(fill = value)) +
+   geom_text(aes(label = value), color="white") +
+   scale_x_discrete(expand = c(0,0)) +
+   scale_y_discrete(expand = c(0,0)) +
+   scale_fill_gradient("Legend label", low = "red", high = "green") + 
+   theme_bw()
> CrossTable(bank.dat$credit.default, bank.dat$subscribed)

 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  45211 

 
                        | bank.dat$subscribed 
bank.dat$credit.default |        no |       yes | Row Total | 
------------------------|-----------|-----------|-----------|
                     no |     39159 |      5237 |     44396 | 
                        |     0.048 |     0.362 |           | 
                        |     0.882 |     0.118 |     0.982 | 
                        |     0.981 |     0.990 |           | 
                        |     0.866 |     0.116 |           | 
------------------------|-----------|-----------|-----------|
                    yes |       763 |        52 |       815 | 
                        |     2.610 |    19.703 |           | 
                        |     0.936 |     0.064 |     0.018 | 
                        |     0.019 |     0.010 |           | 
                        |     0.017 |     0.001 |           | 
------------------------|-----------|-----------|-----------|
           Column Total |     39922 |      5289 |     45211 | 
                        |     0.883 |     0.117 |           | 
------------------------|-----------|-----------|-----------|

 
> z <- melt(data.frame(table(bank.dat$credit.default, bank.dat$subscribed)))
Using Var1, Var2 as id variables
> colnames(z) <- c("credit.default", "subscribed","variable","value")
> ggplot(z, aes(subscribed, credit.default)) +
+   geom_tile(aes(fill = value)) +
+   geom_text(aes(label = value), color="white") +
+   scale_x_discrete(expand = c(0,0)) +
+   scale_y_discrete(expand = c(0,0)) +
+   scale_fill_gradient("Legend label", low = "red", high = "green") + 
+   theme_bw()
> CrossTable(bank.dat$has.housing.loan, bank.dat$subscribed)

 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  45211 

 
                          | bank.dat$subscribed 
bank.dat$has.housing.loan |        no |       yes | Row Total | 
--------------------------|-----------|-----------|-----------|
                       no |     16727 |      3354 |     20081 | 
                          |    56.942 |   429.802 |           | 
                          |     0.833 |     0.167 |     0.444 | 
                          |     0.419 |     0.634 |           | 
                          |     0.370 |     0.074 |           | 
--------------------------|-----------|-----------|-----------|
                      yes |     23195 |      1935 |     25130 | 
                          |    45.501 |   343.449 |           | 
                          |     0.923 |     0.077 |     0.556 | 
                          |     0.581 |     0.366 |           | 
                          |     0.513 |     0.043 |           | 
--------------------------|-----------|-----------|-----------|
             Column Total |     39922 |      5289 |     45211 | 
                          |     0.883 |     0.117 |           | 
--------------------------|-----------|-----------|-----------|

 
> z <- melt(data.frame(table(bank.dat$has.housing.loan, bank.dat$subscribed)))
Using Var1, Var2 as id variables
> colnames(z) <- c("has.housing.loan", "subscribed","variable","value")
> ggplot(z, aes(subscribed, has.housing.loan)) +
+   geom_tile(aes(fill = value)) +
+   geom_text(aes(label = value), color="white") +
+   scale_x_discrete(expand = c(0,0)) +
+   scale_y_discrete(expand = c(0,0)) +
+   scale_fill_gradient("Legend label", low = "red", high = "green") + 
+   theme_bw()
> CrossTable(bank.dat$has.personal.loan,bank.dat$subscribed)

 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  45211 

 
                           | bank.dat$subscribed 
bank.dat$has.personal.loan |        no |       yes | Row Total | 
---------------------------|-----------|-----------|-----------|
                        no |     33162 |      4805 |     37967 | 
                           |     3.940 |    29.739 |           | 
                           |     0.873 |     0.127 |     0.840 | 
                           |     0.831 |     0.908 |           | 
                           |     0.733 |     0.106 |           | 
---------------------------|-----------|-----------|-----------|
                       yes |      6760 |       484 |      7244 | 
                           |    20.650 |   155.866 |           | 
                           |     0.933 |     0.067 |     0.160 | 
                           |     0.169 |     0.092 |           | 
                           |     0.150 |     0.011 |           | 
---------------------------|-----------|-----------|-----------|
              Column Total |     39922 |      5289 |     45211 | 
                           |     0.883 |     0.117 |           | 
---------------------------|-----------|-----------|-----------|

 
> z <- melt(data.frame(table(bank.dat$has.personal.loan, bank.dat$subscribed)))
Using Var1, Var2 as id variables
> colnames(z) <- c("has.personal.loan", "subscribed","variable","value")
> ggplot(z, aes(subscribed, has.personal.loan)) +
+   geom_tile(aes(fill = value)) +
+   geom_text(aes(label = value), color="white") +
+   scale_x_discrete(expand = c(0,0)) +
+   scale_y_discrete(expand = c(0,0)) +
+   scale_fill_gradient("Legend label", low = "red", high = "green") + 
+   theme_bw()
> CrossTable(bank.dat$contact.type,bank.dat$subscribed)

 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  45211 

 
                      | bank.dat$subscribed 
bank.dat$contact.type |        no |       yes | Row Total | 
----------------------|-----------|-----------|-----------|
             cellular |     24916 |      4369 |     29285 | 
                      |    34.396 |   259.622 |           | 
                      |     0.851 |     0.149 |     0.648 | 
                      |     0.624 |     0.826 |           | 
                      |     0.551 |     0.097 |           | 
----------------------|-----------|-----------|-----------|
            telephone |      2516 |       390 |      2906 | 
                      |     0.976 |     7.366 |           | 
                      |     0.866 |     0.134 |     0.064 | 
                      |     0.063 |     0.074 |           | 
                      |     0.056 |     0.009 |           | 
----------------------|-----------|-----------|-----------|
              unknown |     12490 |       530 |     13020 | 
                      |    85.791 |   647.564 |           | 
                      |     0.959 |     0.041 |     0.288 | 
                      |     0.313 |     0.100 |           | 
                      |     0.276 |     0.012 |           | 
----------------------|-----------|-----------|-----------|
         Column Total |     39922 |      5289 |     45211 | 
                      |     0.883 |     0.117 |           | 
----------------------|-----------|-----------|-----------|

 
> z <- melt(data.frame(table(bank.dat$contact.type, bank.dat$subscribed)))
Using Var1, Var2 as id variables
> colnames(z) <- c("contact.type", "subscribed","variable","value")
> ggplot(z, aes(subscribed, contact.type)) +
+   geom_tile(aes(fill = value)) +
+   geom_text(aes(label = value), color="white") +
+   scale_x_discrete(expand = c(0,0)) +
+   scale_y_discrete(expand = c(0,0)) +
+   scale_fill_gradient("Legend label", low = "red", high = "green") + 
+   theme_bw()
> CrossTable(bank.dat$last.contact.dom,bank.dat$subscribed)

 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  45211 

 
                          | bank.dat$subscribed 
bank.dat$last.contact.dom |        no |       yes | Row Total | 
--------------------------|-----------|-----------|-----------|
                        1 |       232 |        90 |       322 | 
                          |     9.631 |    72.699 |           | 
                          |     0.720 |     0.280 |     0.007 | 
                          |     0.006 |     0.017 |           | 
                          |     0.005 |     0.002 |           | 
--------------------------|-----------|-----------|-----------|
                        2 |      1111 |       182 |      1293 | 
                          |     0.828 |     6.247 |           | 
                          |     0.859 |     0.141 |     0.029 | 
                          |     0.028 |     0.034 |           | 
                          |     0.025 |     0.004 |           | 
--------------------------|-----------|-----------|-----------|
                        3 |       901 |       178 |      1079 | 
                          |     2.813 |    21.235 |           | 
                          |     0.835 |     0.165 |     0.024 | 
                          |     0.023 |     0.034 |           | 
                          |     0.020 |     0.004 |           | 
--------------------------|-----------|-----------|-----------|
                        4 |      1215 |       230 |      1445 | 
                          |     2.912 |    21.981 |           | 
                          |     0.841 |     0.159 |     0.032 | 
                          |     0.030 |     0.043 |           | 
                          |     0.027 |     0.005 |           | 
--------------------------|-----------|-----------|-----------|
                        5 |      1695 |       215 |      1910 | 
                          |     0.042 |     0.319 |           | 
                          |     0.887 |     0.113 |     0.042 | 
                          |     0.042 |     0.041 |           | 
                          |     0.037 |     0.005 |           | 
--------------------------|-----------|-----------|-----------|
                        6 |      1751 |       181 |      1932 | 
                          |     1.188 |     8.965 |           | 
                          |     0.906 |     0.094 |     0.043 | 
                          |     0.044 |     0.034 |           | 
                          |     0.039 |     0.004 |           | 
--------------------------|-----------|-----------|-----------|
                        7 |      1660 |       157 |      1817 | 
                          |     1.924 |    14.523 |           | 
                          |     0.914 |     0.086 |     0.040 | 
                          |     0.042 |     0.030 |           | 
                          |     0.037 |     0.003 |           | 
--------------------------|-----------|-----------|-----------|
                        8 |      1641 |       201 |      1842 | 
                          |     0.129 |     0.974 |           | 
                          |     0.891 |     0.109 |     0.041 | 
                          |     0.041 |     0.038 |           | 
                          |     0.036 |     0.004 |           | 
--------------------------|-----------|-----------|-----------|
                        9 |      1382 |       179 |      1561 | 
                          |     0.009 |     0.071 |           | 
                          |     0.885 |     0.115 |     0.035 | 
                          |     0.035 |     0.034 |           | 
                          |     0.031 |     0.004 |           | 
--------------------------|-----------|-----------|-----------|
                       10 |       403 |       121 |       524 | 
                          |     7.703 |    58.142 |           | 
                          |     0.769 |     0.231 |     0.012 | 
                          |     0.010 |     0.023 |           | 
                          |     0.009 |     0.003 |           | 
--------------------------|-----------|-----------|-----------|
                       11 |      1298 |       181 |      1479 | 
                          |     0.049 |     0.368 |           | 
                          |     0.878 |     0.122 |     0.033 | 
                          |     0.033 |     0.034 |           | 
                          |     0.029 |     0.004 |           | 
--------------------------|-----------|-----------|-----------|
                       12 |      1359 |       244 |      1603 | 
                          |     2.253 |    17.007 |           | 
                          |     0.848 |     0.152 |     0.035 | 
                          |     0.034 |     0.046 |           | 
                          |     0.030 |     0.005 |           | 
--------------------------|-----------|-----------|-----------|
                       13 |      1344 |       241 |      1585 | 
                          |     2.207 |    16.660 |           | 
                          |     0.848 |     0.152 |     0.035 | 
                          |     0.034 |     0.046 |           | 
                          |     0.030 |     0.005 |           | 
--------------------------|-----------|-----------|-----------|
                       14 |      1638 |       210 |      1848 | 
                          |     0.023 |     0.177 |           | 
                          |     0.886 |     0.114 |     0.041 | 
                          |     0.041 |     0.040 |           | 
                          |     0.036 |     0.005 |           | 
--------------------------|-----------|-----------|-----------|
                       15 |      1465 |       238 |      1703 | 
                          |     1.000 |     7.547 |           | 
                          |     0.860 |     0.140 |     0.038 | 
                          |     0.037 |     0.045 |           | 
                          |     0.032 |     0.005 |           | 
--------------------------|-----------|-----------|-----------|
                       16 |      1223 |       192 |      1415 | 
                          |     0.561 |     4.232 |           | 
                          |     0.864 |     0.136 |     0.031 | 
                          |     0.031 |     0.036 |           | 
                          |     0.027 |     0.004 |           | 
--------------------------|-----------|-----------|-----------|
                       17 |      1763 |       176 |      1939 | 
                          |     1.509 |    11.392 |           | 
                          |     0.909 |     0.091 |     0.043 | 
                          |     0.044 |     0.033 |           | 
                          |     0.039 |     0.004 |           | 
--------------------------|-----------|-----------|-----------|
                       18 |      2080 |       228 |      2308 | 
                          |     0.866 |     6.534 |           | 
                          |     0.901 |     0.099 |     0.051 | 
                          |     0.052 |     0.043 |           | 
                          |     0.046 |     0.005 |           | 
--------------------------|-----------|-----------|-----------|
                       19 |      1635 |       122 |      1757 | 
                          |     4.499 |    33.956 |           | 
                          |     0.931 |     0.069 |     0.039 | 
                          |     0.041 |     0.023 |           | 
                          |     0.036 |     0.003 |           | 
--------------------------|-----------|-----------|-----------|
                       20 |      2560 |       192 |      2752 | 
                          |     6.948 |    52.447 |           | 
                          |     0.930 |     0.070 |     0.061 | 
                          |     0.064 |     0.036 |           | 
                          |     0.057 |     0.004 |           | 
--------------------------|-----------|-----------|-----------|
                       21 |      1825 |       201 |      2026 | 
                          |     0.725 |     5.472 |           | 
                          |     0.901 |     0.099 |     0.045 | 
                          |     0.046 |     0.038 |           | 
                          |     0.040 |     0.004 |           | 
--------------------------|-----------|-----------|-----------|
                       22 |       751 |       154 |       905 | 
                          |     2.899 |    21.879 |           | 
                          |     0.830 |     0.170 |     0.020 | 
                          |     0.019 |     0.029 |           | 
                          |     0.017 |     0.003 |           | 
--------------------------|-----------|-----------|-----------|
                       23 |       813 |       126 |       939 | 
                          |     0.315 |     2.375 |           | 
                          |     0.866 |     0.134 |     0.021 | 
                          |     0.020 |     0.024 |           | 
                          |     0.018 |     0.003 |           | 
--------------------------|-----------|-----------|-----------|
                       24 |       385 |        62 |       447 | 
                          |     0.239 |     1.802 |           | 
                          |     0.861 |     0.139 |     0.010 | 
                          |     0.010 |     0.012 |           | 
                          |     0.009 |     0.001 |           | 
--------------------------|-----------|-----------|-----------|
                       25 |       707 |       133 |       840 | 
                          |     1.626 |    12.276 |           | 
                          |     0.842 |     0.158 |     0.019 | 
                          |     0.018 |     0.025 |           | 
                          |     0.016 |     0.003 |           | 
--------------------------|-----------|-----------|-----------|
                       26 |       919 |       116 |      1035 | 
                          |     0.028 |     0.213 |           | 
                          |     0.888 |     0.112 |     0.023 | 
                          |     0.023 |     0.022 |           | 
                          |     0.020 |     0.003 |           | 
--------------------------|-----------|-----------|-----------|
                       27 |       971 |       150 |      1121 | 
                          |     0.359 |     2.712 |           | 
                          |     0.866 |     0.134 |     0.025 | 
                          |     0.024 |     0.028 |           | 
                          |     0.021 |     0.003 |           | 
--------------------------|-----------|-----------|-----------|
                       28 |      1687 |       143 |      1830 | 
                          |     3.127 |    23.602 |           | 
                          |     0.922 |     0.078 |     0.040 | 
                          |     0.042 |     0.027 |           | 
                          |     0.037 |     0.003 |           | 
--------------------------|-----------|-----------|-----------|
                       29 |      1616 |       129 |      1745 | 
                          |     3.664 |    27.657 |           | 
                          |     0.926 |     0.074 |     0.039 | 
                          |     0.040 |     0.024 |           | 
                          |     0.036 |     0.003 |           | 
--------------------------|-----------|-----------|-----------|
                       30 |      1295 |       271 |      1566 | 
                          |     5.575 |    42.081 |           | 
                          |     0.827 |     0.173 |     0.035 | 
                          |     0.032 |     0.051 |           | 
                          |     0.029 |     0.006 |           | 
--------------------------|-----------|-----------|-----------|
                       31 |       597 |        46 |       643 | 
                          |     1.504 |    11.352 |           | 
                          |     0.928 |     0.072 |     0.014 | 
                          |     0.015 |     0.009 |           | 
                          |     0.013 |     0.001 |           | 
--------------------------|-----------|-----------|-----------|
             Column Total |     39922 |      5289 |     45211 | 
                          |     0.883 |     0.117 |           | 
--------------------------|-----------|-----------|-----------|

 
> z <- melt(data.frame(table(bank.dat$last.contact.dom, bank.dat$subscribed)))
Using Var1, Var2 as id variables
> colnames(z) <- c("last.contact.dom", "subscribed","variable","value")
> ggplot(z, aes(subscribed, last.contact.dom)) +
+   geom_tile(aes(fill = value)) +
+   geom_text(aes(label = value), color="white") +
+   scale_x_discrete(expand = c(0,0)) +
+   scale_y_discrete(expand = c(0,0)) +
+   scale_fill_gradient("Legend label", low = "red", high = "green") + 
+   theme_bw()
> CrossTable(bank.dat$last.contact.moy, bank.dat$subscribed)

 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  45211 

 
                          | bank.dat$subscribed 
bank.dat$last.contact.moy |        no |       yes | Row Total | 
--------------------------|-----------|-----------|-----------|
                      apr |      2355 |       577 |      2932 | 
                          |    21.150 |   159.639 |           | 
                          |     0.803 |     0.197 |     0.065 | 
                          |     0.059 |     0.109 |           | 
                          |     0.052 |     0.013 |           | 
--------------------------|-----------|-----------|-----------|
                      aug |      5559 |       688 |      6247 | 
                          |     0.332 |     2.507 |           | 
                          |     0.890 |     0.110 |     0.138 | 
                          |     0.139 |     0.130 |           | 
                          |     0.123 |     0.015 |           | 
--------------------------|-----------|-----------|-----------|
                      dec |       114 |       100 |       214 | 
                          |    29.740 |   224.480 |           | 
                          |     0.533 |     0.467 |     0.005 | 
                          |     0.003 |     0.019 |           | 
                          |     0.003 |     0.002 |           | 
--------------------------|-----------|-----------|-----------|
                      feb |      2208 |       441 |      2649 | 
                          |     7.349 |    55.468 |           | 
                          |     0.834 |     0.166 |     0.059 | 
                          |     0.055 |     0.083 |           | 
                          |     0.049 |     0.010 |           | 
--------------------------|-----------|-----------|-----------|
                      jan |      1261 |       142 |      1403 | 
                          |     0.395 |     2.984 |           | 
                          |     0.899 |     0.101 |     0.031 | 
                          |     0.032 |     0.027 |           | 
                          |     0.028 |     0.003 |           | 
--------------------------|-----------|-----------|-----------|
                      jul |      6268 |       627 |      6895 | 
                          |     5.299 |    39.994 |           | 
                          |     0.909 |     0.091 |     0.153 | 
                          |     0.157 |     0.119 |           | 
                          |     0.139 |     0.014 |           | 
--------------------------|-----------|-----------|-----------|
                      jun |      4795 |       546 |      5341 | 
                          |     1.317 |     9.942 |           | 
                          |     0.898 |     0.102 |     0.118 | 
                          |     0.120 |     0.103 |           | 
                          |     0.106 |     0.012 |           | 
--------------------------|-----------|-----------|-----------|
                      mar |       229 |       248 |       477 | 
                          |    87.703 |   661.989 |           | 
                          |     0.480 |     0.520 |     0.011 | 
                          |     0.006 |     0.047 |           | 
                          |     0.005 |     0.005 |           | 
--------------------------|-----------|-----------|-----------|
                      may |     12841 |       925 |     13766 | 
                          |    38.648 |   291.721 |           | 
                          |     0.933 |     0.067 |     0.304 | 
                          |     0.322 |     0.175 |           | 
                          |     0.284 |     0.020 |           | 
--------------------------|-----------|-----------|-----------|
                      nov |      3567 |       403 |      3970 | 
                          |     1.076 |     8.125 |           | 
                          |     0.898 |     0.102 |     0.088 | 
                          |     0.089 |     0.076 |           | 
                          |     0.079 |     0.009 |           | 
--------------------------|-----------|-----------|-----------|
                      oct |       415 |       323 |       738 | 
                          |    85.950 |   648.758 |           | 
                          |     0.562 |     0.438 |     0.016 | 
                          |     0.010 |     0.061 |           | 
                          |     0.009 |     0.007 |           | 
--------------------------|-----------|-----------|-----------|
                      sep |       310 |       269 |       579 | 
                          |    79.231 |   598.042 |           | 
                          |     0.535 |     0.465 |     0.013 | 
                          |     0.008 |     0.051 |           | 
                          |     0.007 |     0.006 |           | 
--------------------------|-----------|-----------|-----------|
             Column Total |     39922 |      5289 |     45211 | 
                          |     0.883 |     0.117 |           | 
--------------------------|-----------|-----------|-----------|

 
> z <- melt(data.frame(table(bank.dat$last.contact.moy, bank.dat$subscribed)))
Using Var1, Var2 as id variables
> colnames(z) <- c("last.contact.moy", "subscribed","variable","value")
> ggplot(z, aes(subscribed, last.contact.moy)) +
+   geom_tile(aes(fill = value)) +
+   geom_text(aes(label = value), color="white") +
+   scale_x_discrete(expand = c(0,0)) +
+   scale_y_discrete(expand = c(0,0)) +
+   scale_fill_gradient("Legend label", low = "red", high = "green") + 
+   theme_bw()
> CrossTable(bank.dat$prev.outcome, bank.dat$subscribed)

 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  45211 

 
                      | bank.dat$subscribed 
bank.dat$prev.outcome |        no |       yes | Row Total | 
----------------------|-----------|-----------|-----------|
              failure |      4283 |       618 |      4901 | 
                      |     0.461 |     3.478 |           | 
                      |     0.874 |     0.126 |     0.108 | 
                      |     0.107 |     0.117 |           | 
                      |     0.095 |     0.014 |           | 
----------------------|-----------|-----------|-----------|
                other |      1533 |       307 |      1840 | 
                      |     5.181 |    39.106 |           | 
                      |     0.833 |     0.167 |     0.041 | 
                      |     0.038 |     0.058 |           | 
                      |     0.034 |     0.007 |           | 
----------------------|-----------|-----------|-----------|
              success |       533 |       978 |      1511 | 
                      |   481.159 |  3631.842 |           | 
                      |     0.353 |     0.647 |     0.033 | 
                      |     0.013 |     0.185 |           | 
                      |     0.012 |     0.022 |           | 
----------------------|-----------|-----------|-----------|
              unknown |     33573 |      3386 |     36959 | 
                      |    26.939 |   203.340 |           | 
                      |     0.908 |     0.092 |     0.817 | 
                      |     0.841 |     0.640 |           | 
                      |     0.743 |     0.075 |           | 
----------------------|-----------|-----------|-----------|
         Column Total |     39922 |      5289 |     45211 | 
                      |     0.883 |     0.117 |           | 
----------------------|-----------|-----------|-----------|

 
> z <- melt(data.frame(table(bank.dat$prev.outcome, bank.dat$subscribed)))
Using Var1, Var2 as id variables
> colnames(z) <- c("prev.outcome", "subscribed","variable","value")
> ggplot(z, aes(subscribed, prev.outcome)) +
+   geom_tile(aes(fill = value)) +
+   geom_text(aes(label = value), color="white") +
+   scale_x_discrete(expand = c(0,0)) +
+   scale_y_discrete(expand = c(0,0)) +
+   scale_fill_gradient("Legend label", low = "red", high = "green") + 
+   theme_bw()